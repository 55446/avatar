

FIR_dragon_category = {

	start_dragon_hunting = {

		icon = hunt_dragons

		allowed = {
			tag = FIR
		}
		visible = {	
			has_country_leader = {
				name = "Sozin"
				ruling_only = yes
			}
			NOT = {
				has_country_flag = befriend_dragons
			}
		}

		available = {
			NOT = {
				has_country_flag = befriend_dragons
			}
		}

		complete_effect = {
			custom_effect_tooltip = dragons_angry_tt
			set_country_flag = hunting_dragons
			unlock_decision_tooltip = dragon_hunt
			hidden_effect = {
				every_state = {
					limit = {
						has_dynamic_modifier = { modifier = dragon_herd }
					}
					FIR = {
						activate_targeted_decision = {
							target = PREV
							decision = dragon_hunt
						}
					}
				}
			}
		}

		cost = 100
		fire_only_once = yes
		ai_will_do = {
			factor = 10
		}
	}

	dragon_hunt = {

		icon = dragon_hunt

		allowed = {
			always = no
		}
		available = {
			has_country_flag = hunting_dragons
			FROM = {
				has_dynamic_modifier = { modifier = dragon_herd }
			}
		}

		state_target = yes
		target_trigger = {
			
		}

		complete_effect = {
			add_manpower = -100
			add_equipment_to_stockpile = {
				type = firebender_equipment
				amount = -100
				producer = FIR
			}
		}

		remove_effect = {
			random_list = {
				80 = {
					custom_effect_tooltip = hunt_successful
					add_stability = 0.05
					add_manpower = 90
					random_list = {
						60 = {
							add_to_variable = {
								var = weekly_accumulated_exhaustion
								value = -10
								tooltip = war_weariness_remove_tooltip
							}
							random_army_leader = {
								limit = {
									NOT = {
										has_trait = dragon_of_the_west
									}
									skill > 2
								}
								unit_leader_event = {
									id = generic.22
								}
							}
							FROM = {
								remove_dynamic_modifier = { modifier = dragon_herd }
								clr_state_flag = hunt_failed_once
								clr_state_flag = hunt_failed_twice
							}
							remove_targeted_decision = {
								target = FROM
								decision = dragon_hunt
							}
						}
						40 = { 
							modifier = {
								add = -30
								FROM = {
									has_state_flag = hunt_failed_once
								}
							}
							hidden_effect = {
								FROM = {
									set_state_flag = hunt_failed_once
								}
							}
						}
					}
				}
				80 = {
					modifier = {
						add = -60
						FROM = {
							has_state_flag = hunt_failed_twice
						}
					}
					FROM = {
						set_state_flag = hunt_failed_twice
					}
					custom_effect_tooltip = hunt_failed
					add_stability = -0.05
					add_war_support = -0.025
				}
			}

		}

		days_remove = 45
		days_re_enable = 30

		custom_cost_trigger = {
			has_manpower > 99
			has_equipment = {
    			firebender_equipment > 99
			}
		}
		custom_cost_text = firebender_100

        ai_will_do = {
			factor = 10
		}
	}


	the_dragon_of_the_west_is_born = {

		allowed = {
			tag = FIR
		}

		visible = {	
			has_country_flag = hunting_dragons
			302 = {
				has_dynamic_modifier = { modifier = dragon_herd }
			}
			#has_unit_leader = 7
			always = no
		}

		available = {
			#has_unit_leader = 7
			always = no
        }

		complete_effect = {
			random_army_leader = { 
				limit = {
					has_id = 7
				}
				unit_leader_event = {
					id = generic.22
				}
			}
		}

		cost = 100
        fire_only_once = yes
        ai_will_do = {
			factor = 10
		}
	}

	alliance_with_the_dragons = {

		icon = befriend_dragons

		allowed = {
			tag = FIR
		}
		visible = {	
			NOT = {
				has_country_flag = hunting_dragons
			}
		}
		available = {
			NOT = {
				has_war = yes
				has_global_flag = air_nomad_genocide
				has_country_flag = hunting_dragons
			}
			has_global_flag = sozins_comet_first
      }

		complete_effect = {
			custom_effect_tooltip = dragons_friendly_tt
			set_country_flag = befriend_dragons
		}

		cost = 100

		fire_only_once = yes
		ai_will_do = {
			factor = 10
		}
	}

}

air_genocide_category = {

	gather_firebender_units = {

		icon = fire_helmet

		allowed = {
			tag = FIR
		}
		visible = {
			has_country_flag = genocide_active
			NOT = {
				has_global_flag = sozins_comet_first
				has_war = yes
			}
		}
		available = {
			has_country_flag = genocide_active
			NOT = {
				has_global_flag = sozins_comet_first
				has_global_flag = air_nomad_genocide
				has_war = yes
			}
			custom_trigger_tooltip = {
				tooltip = not_max_unit_capacity_ttp
				check_variable = { genocide_preparation < 20 }
			}
		}

		days_remove = 7

		custom_cost_trigger = {
			has_equipment = { firebender_equipment > 79 }
		}
		custom_cost_text = firebender_80

		#cost = 50

		complete_effect = {
			add_equipment_to_stockpile = {
				type = firebender_equipment
				amount = -80
				producer = ROOT
			}
			add_to_variable = {
				var = genocide_preparation
				value = 1
			}
		}

		ai_will_do = {
			factor = 100
		}

	}

	FIR_send_royal_guards_as_support = {

		icon = fire_royal_guard

		allowed = {
			tag = FIR
		}
		visible = {
			has_country_flag = genocide_active
			NOT = {
				has_global_flag = sozins_comet_first
				has_war = yes
			}
		}
		available = {
			has_country_flag = genocide_active
			NOT = {
				has_global_flag = sozins_comet_first
				has_global_flag = air_nomad_genocide
				has_war = yes
			}
		}

		days_remove = -1

		cost = 100

		complete_effect = {
			set_country_flag = duplicate_units
			custom_effect_tooltip = FIR_duplicate_genocide_units
		}

		ai_will_do = {
			factor = 100
		}

	}

	FIR_northern_operation_base = {

		icon = northern_air_temple

		allowed = {
			tag = FIR
		}
		visible = {
			has_country_flag = genocide_active
			NOT = {
				has_global_flag = sozins_comet_first
				has_war = yes
			}
		}
		available = {
			has_country_flag = genocide_active
			NOT = {
				has_global_flag = sozins_comet_first
				has_global_flag = air_nomad_genocide
				has_war = yes
			}
		}

		days_remove = 30

		fire_only_once = yes

		custom_cost_trigger = {
			check_variable = { tax_balance > 0.1 }
		}
		custom_cost_text = expenses_100

		modifier = {
			expenses_factor = 0.1
		}

		complete_effect = {
			
		}

		remove_effect = {
			custom_effect_tooltip = on_invasion_construction_ttp
			set_country_flag = north_extra_construction
		}

		ai_will_do = {
			factor = 100
		}

	}

	FIR_eastern_operation_base = {

		icon = eastern_air_temple

		allowed = {
			tag = FIR
		}
		visible = {
			has_country_flag = genocide_active
			NOT = {
				has_global_flag = sozins_comet_first
				has_war = yes
			}
		}
		available = {
			has_country_flag = genocide_active
			NOT = {
				has_global_flag = sozins_comet_first
				has_global_flag = air_nomad_genocide
				has_war = yes
			}
		}

		days_remove = 30

		fire_only_once = yes

		custom_cost_trigger = {
			check_variable = { tax_balance > 0.1 }
		}
		custom_cost_text = expenses_100

		modifier = {
			expenses_factor = 0.1
		}

		complete_effect = {
			
		}

		remove_effect = {
			419 = {
				add_building_construction = {
					type = naval_base
					level = 8
					instant_build = yes
					province = 5597
				}
			}
			custom_effect_tooltip = on_invasion_construction_ttp
			set_country_flag = east_extra_construction
		}

		ai_will_do = {
			factor = 100
		}

	}

	FIR_southern_operation_base = {

		icon = southern_air_temple

		allowed = {
			tag = FIR
		}
		visible = {
			has_country_flag = genocide_active
			NOT = {
				has_global_flag = sozins_comet_first
				has_war = yes
			}
		}
		available = {
			has_country_flag = genocide_active
			NOT = {
				has_global_flag = sozins_comet_first
				has_global_flag = air_nomad_genocide
				has_war = yes
			}
		}

		days_remove = 30

		fire_only_once = yes

		custom_cost_trigger = {
			check_variable = { tax_balance > 0.1 }
		}
		custom_cost_text = expenses_100

		modifier = {
			expenses_factor = 0.1
		}

		complete_effect = {
			
		}

		remove_effect = {
			404 = {
				add_building_construction = {
					type = naval_base
					level = 8
					instant_build = yes
					province = 10569
				}
			}
			custom_effect_tooltip = on_invasion_construction_ttp
			set_country_flag = south_extra_construction
		}

		ai_will_do = {
			factor = 100
		}

	}

	FIR_western_operation_base = {

		icon = western_air_temple

		allowed = {
			tag = FIR
		}
		visible = {
			has_country_flag = genocide_active
			NOT = {
				has_global_flag = sozins_comet_first
				has_war = yes
			}
		}
		available = {
			has_country_flag = genocide_active
			NOT = {
				has_global_flag = sozins_comet_first
				has_global_flag = air_nomad_genocide
				has_war = yes
			}
		}

		days_remove = 30

		fire_only_once = yes

		custom_cost_trigger = {
			check_variable = { tax_balance > 0.1 }
		}
		custom_cost_text = expenses_100

		modifier = {
			expenses_factor = 0.1
		}

		complete_effect = {
			
		}

		remove_effect = {
			264 = {
				add_building_construction = {
					type = naval_base
					level = 8
					instant_build = yes
					province = 7281
				}
			}
			custom_effect_tooltip = on_invasion_construction_ttp
			set_country_flag = west_extra_construction
		}

		ai_will_do = {
			factor = 100
		}

	}
	
	FIR_occupy_northern_temple_lands = {

		icon = northern_air_temple
		
		allowed = {
			tag = FIR
		}
		visible = {
			has_country_flag = genocide_active
			has_country_flag = north_extra_construction
			NOT = {
				has_war_with = NAT
			}
		}
		available = {
			has_country_flag = genocide_active
			has_country_flag = north_extra_construction
		}
		fire_only_once = yes
		days_remove = 20
		modifier = {
			expenses_factor = 0.15
		}
		remove_effect = {
			custom_effect_tooltip = NAT_occupied_tt
			hidden_effect = {
				NAT = {
					every_owned_state = {
						limit = {
							is_capital = no
						}
						set_demilitarized_zone = yes
					}
				}	
			}
			set_global_flag = NAT_occupied
		}

		ai_will_do = {
			factor = 100
		}
	}

	FIR_occupy_western_temple_lands = {

		icon = western_air_temple

		allowed = {
			tag = FIR
		}
		visible = {
			has_country_flag = genocide_active
			has_country_flag = west_extra_construction
			NOT = {
				has_war_with = WAT
			}
		}
		available = {
			has_country_flag = genocide_active
			has_country_flag = west_extra_construction
		}

		fire_only_once = yes
		days_remove = 20
		modifier = {
			expenses_factor = 0.15
		}
		remove_effect = {
			custom_effect_tooltip = WAT_occupied_tt
			hidden_effect = {
				WAT = {
					every_owned_state = {
						limit = {
							is_capital = no
						}
						set_demilitarized_zone = yes
					}
				}	
			}
			set_global_flag = WAT_occupied
		}

		ai_will_do = {
			factor = 100
		}
	}

	FIR_occupy_southern_temple_lands = {

		icon = southern_air_temple

		allowed = {
			tag = FIR
		}
		visible = {
			has_country_flag = genocide_active
			has_country_flag = south_extra_construction
			NOT = {
				has_war_with = SAT
			}
		}
		available = {
			has_country_flag = genocide_active
			has_country_flag = south_extra_construction
		}

		fire_only_once = yes
		days_remove = 20
		modifier = {
			expenses_factor = 0.15
		}
		remove_effect = {
			custom_effect_tooltip = SAT_occupied_tt
			hidden_effect = {
				SAT = {
					every_owned_state = {
						limit = {
							is_capital = no
						}
						set_demilitarized_zone = yes
					}
				}	
			}
			set_global_flag = SAT_occupied
		}

		ai_will_do = {
			factor = 100
		}
	}

	FIR_occupy_eastern_temple_lands = {

		icon = eastern_air_temple

		allowed = {
			tag = FIR
		}
		visible = {
			has_country_flag = genocide_active
			has_country_flag = east_extra_construction
			NOT = {
				has_war_with = EAT
			}
		}
		available = {
			has_country_flag = genocide_active
			has_country_flag = east_extra_construction
		}

		fire_only_once = yes
		days_remove = 20
		modifier = {
			expenses_factor = 0.15
		}
		remove_effect = {
			custom_effect_tooltip = EAT_occupied_tt
			hidden_effect = {
				EAT = {
					every_owned_state = {
						limit = {
							is_capital = no
						}
						set_demilitarized_zone = yes
					}
				}	
			}
			set_global_flag = EAT_occupied
		}

		ai_will_do = {
			factor = 100
		}
	}


	FIR_eastern_temple_attack = {

		icon = eastern_air_temple

		allowed = {
			always = no
		}
		visible = {

		}
		available = {
			GIF = {
				controls_state = 188
			}
		}


		days_mission_timeout = 90
		fire_only_once = yes

		activation = {

		}

		is_good = no

		complete_effect = {
			FIR = {
				country_event = { id = air_gen.6 days = 7 }
			}
			set_global_flag = east_temple_fallen
		}

		timeout_effect = {
			if = {
				limit = {
					EAT = { is_ai = yes }
					is_historical_focus_on = yes
					NOT = {
						188 = {
							is_fully_controlled_by = EAT
						}
					}
				}
				FIR = {
					country_event = { id = air_gen.6 days = 7 }
				}
				EAT = {
					dismantle_faction = yes
				}
				set_global_flag = east_temple_fallen
			}
			else = {
				EAT = {
					white_peace = GIF
					#give_military_access = GIF
					leave_faction = yes
					every_state = {
						limit = {
							is_core_of = EAT
						}
						transfer_state_to = EAT
					}
				}
				set_global_flag = east_temple_survived
			}
		}

		ai_will_do = {
			factor = 100
		}

	}

	
	FIR_western_temple_attack = {

		icon = western_air_temple

		allowed = {
			always = no
		}
		visible = {
			
		}
		available = {
			GIF = {
				controls_state = 208
			}
		}


		days_mission_timeout = 90
		fire_only_once = yes

		activation = {

		}

		is_good = no

		complete_effect = {
			FIR = {
				country_event = { id = air_gen.3 days = 7 }
			}
			set_global_flag = west_temple_fallen
		}

		timeout_effect = {
			if = {
				limit = {
					NOT = {
						208 = {
							is_fully_controlled_by = WAT
						}
					}
					WAT = { is_ai = yes }
					is_historical_focus_on = yes
				}
				FIR = {
					country_event = { id = air_gen.3 days = 7 }
				}
				WAT = {
					dismantle_faction = yes
				}
				set_global_flag = west_temple_fallen
			}
			else = {
				WAT = {
					white_peace = WAT
					#give_military_access = FIR
					leave_faction = yes
					every_state = {
						limit = {
							is_core_of = WAT
						}
						transfer_state_to = WAT
					}
				}
				set_global_flag = west_temple_survived
			}
		}

		ai_will_do = {
			factor = 100
		}

	}

	
	FIR_northern_temple_attack = {

		icon = northern_air_temple

		allowed = {
			always = no
		}
		visible = {
			
		}
		available = {
			GIF = {
				controls_state = 316
			}
		}


		days_mission_timeout = 90
		fire_only_once = yes

		activation = {

		}

		is_good = no

		complete_effect = {
			FIR = {
				country_event = { id = air_gen.5 days = 7 }
			}
			set_global_flag = north_temple_fallen
		}

		timeout_effect = {
			if = {
				limit = {
					NOT = {
						316 = {
							is_fully_controlled_by = NAT
						}
					}
					NAT = { is_ai = yes }
					is_historical_focus_on = yes
				}
				FIR = {
					country_event = { id = air_gen.5 days = 7 }
				}
				NAT = {
					dismantle_faction = yes
				}
				set_global_flag = north
			}
			else = {
				NAT = {
					white_peace = GIF
					#give_military_access = FIR
					leave_faction = yes
					every_state = {
						limit = {
							is_core_of = NAT
						}
						transfer_state_to = NAT
					}
				}
				set_global_flag = north_temple_survived
			}
		}

		ai_will_do = {
			factor = 100
		}

	}

	
	FIR_southern_temple_attack = {

		icon = southern_air_temple

		allowed = {
			always = no
		}
		visible = {
			
		}
		available = {
			GIF = {
				controls_state = 329
			}
		}


		days_mission_timeout = 90
		fire_only_once = yes

		activation = {

		}

		is_good = no

		complete_effect = {
			FIR = {
				country_event = { id = air_gen.4 days = 7 }
			}
			SAT = {
				dismantle_faction = yes
			}
			set_global_flag = south_temple_fallen
		}

		timeout_effect = {
			if = {
				limit = {
					NOT = {
						329 = {
							is_fully_controlled_by = SAT
						}
					}
					SAT = { is_ai = yes }
					is_historical_focus_on = yes
				}
				FIR = {
					country_event = { id = air_gen.4 days = 7 }
				}
				SAT = {
					dismantle_faction = yes
				}
				set_global_flag = south_temple_fallen
			}
			else = {
				SAT = {
					white_peace = GIF
					#give_military_access = FIR
					leave_faction = yes
					every_state = {
						limit = {
							is_core_of = SAT
						}
						transfer_state_to = SAT
					}
				}
				set_global_flag = south_temple_survived
			}
		}

		ai_will_do = {
			factor = 100
		}

	}

}
