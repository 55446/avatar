
scripted_gui = {

	economy_state_ui = {
		context_type = selected_state_context
		
		window_name = "economy_state_ui_window"
		parent_window_token = selected_state_view

		visible = {
			always = yes
		}

		effects = {
			open_construction_click = {
				if = {
					limit = {
						ROOT = {
						check_variable = { close_construction = 0 }
						}
					}
					ROOT = {
					set_variable = { close_construction = 1 }
					}
				}
				else = {
					ROOT = {
					set_variable = { close_construction = 0 }
					}
				}
				if = {
					limit = {
						ROOT = {
						check_variable = { show_construction < 1 }
						}
					}
					ROOT = {
					set_variable = { show_construction = 1 }
					}
				}
			}
			
			send_settlers_click = {

				ROOT = {
					transfer_state = PREV

					add_timed_idea = { idea = colonial_investments  days = 365 }

				}

				THIS = {
					add_dynamic_modifier = { modifier = new_settlement }

					set_variable = {
						var = fire_pop
						value = ROOT.party_popularity_100@fire_culture
						tooltip = set_fire_pop_tt
					}
					set_variable = {
						var = earth_pop
						value = ROOT.party_popularity_100@earth_culture
						tooltip = set_earth_pop_tt
					}
					set_variable = {
						var = water_pop
						value = ROOT.party_popularity_100@water_culture
						tooltip = set_water_pop_tt
					}
					set_variable = {
						var = air_pop
						value = ROOT.party_popularity_100@air_culture
						tooltip = set_air_pop_tt
					}
					set_variable = {
						var = nonbender_pop
						value = ROOT.party_popularity_100@pluralist_culture
						tooltip = set_nonbender_pop_tt
					}

					state_culture_pie_chart_recalc = yes

					set_building_level = {
					    type = naval_base
					    level = 5
					    province = {
					        all_provinces = yes
					        limit_to_coastal = yes
					        level < 5
					        level > 0
					    }
					}
				}
			}
		}

		triggers = {

			send_settlers_click_enabled = {

				ROOT = {
					NOT = {
						has_idea = colonial_investments
					}
					has_political_power > THIS.mtth:colonise_state_cost
				}

				NOT = {
					is_core_of = ROOT
					is_controlled_by = ROOT
					has_dynamic_modifier = { modifier = new_settlement }
				}

				OR = {
					any_province_building_level = {
						province = {
							all_provinces = yes
							limit_to_coastal = yes
						}
						building = naval_base
						level > 0
					}
					any_neighbor_state = {
						is_controlled_by = ROOT
					}
				}
				has_dynamic_modifier = { modifier = genocide_state }
			}

			send_settlers_visible = {
				NOT = {
					is_core_of = ROOT
					is_controlled_by = ROOT
				}
			}

			open_construction_visible = {
				OR = {
					is_controlled_by = ROOT
					controller = {
						is_puppet_of = ROOT
					}
				}
			}

			forest_icon_visible = {
				has_variable = forest
			}
			forest_visible = {
				has_variable = forest
			}
			mountain_icon_visible = {
				has_variable = mountain
			}
			mountain_visible = {
				has_variable = mountain
			}
			field_icon_visible = {
				has_variable = field
			}
			field_visible = {
				has_variable = field
			}
			water_icon_visible = {
				has_variable = water
			}
			water_visible = {
				has_variable = water
			}
			stonefield_icon_visible = {
				has_variable = stonefield
			}
			stonefield_visible = {
				has_variable = stonefield
			}
			animal_icon_visible = {
				has_variable = animal
			}
			animal_visible = {
				has_variable = animal
			}
		}

		ai_test_interval = 8000
		ai_test_variance = 0.1
		
		ai_enabled = {
			always = yes
		}
		
		ai_check = {
			check_variable = { ai_irrationality > 0 }
		}
		
		ai_max_weight_taken_per_test = 1
		ai_weights = {
			send_settlers_click = {
				ai_will_do = {
					base = 10
					
				}
			}
		}

	}
	
}
